(this["webpackJsonpeventlist-admin"]=this["webpackJsonpeventlist-admin"]||[]).push([[0],{192:function(e){e.exports=JSON.parse('{"a":"0.0.3"}')},283:function(e,t,a){e.exports=a(533)},288:function(e,t,a){},521:function(e){e.exports=JSON.parse("{}")},522:function(e){e.exports=JSON.parse("{}")},523:function(e){e.exports=JSON.parse("{}")},524:function(e){e.exports=JSON.parse("{}")},525:function(e){e.exports=JSON.parse("{}")},526:function(e){e.exports=JSON.parse("{}")},527:function(e){e.exports=JSON.parse("{}")},528:function(e){e.exports=JSON.parse("{}")},529:function(e){e.exports=JSON.parse("{}")},530:function(e){e.exports=JSON.parse("{}")},533:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),r=a(16),i=a.n(r),o=(a(595),a(594),a(577)),l=(a(288),a(271)),c=a(23),u=a(24),d=a(26),p=a(25),h=a(7),m=a(592),g=a(596),f=a(593),v=a(265),b=a.n(v),E=a(189),C=a.n(E),y=a(5),S=a.n(y),x=a(600),k=a(206),N=a(260),w=a(599),I=a(251),T=a(249),O=a(263),D=a(145),F=a(581),j=a(261),A=a(20),B=a(266),L=a.n(B),P=a(267),R=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleClick=function(){n.setState({displayColorPicker:!n.state.displayColorPicker})},n.handleClose=function(){n.setState({displayColorPicker:!1})},n.handleChange=function(e){n.setState({color:e}),n.props.onChange&&n.props.onChange(a.getColor(e))},n.state={displayColorPicker:!1,color:n.props.color},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=a.getColor(this.state.color);return s.a.createElement("div",{style:this.props.style},s.a.createElement(x.a,{id:"name",style:{width:"calc(100% - 80px)"},label:this.props.name||"color",value:t,margin:"dense",classes:{root:this.props.classes.textDense},onChange:function(t){return e.handleChange(t.target.value)}}),s.a.createElement(D.a,{onClick:function(){return e.handleChange("")},size:"small",className:this.props.classes.delButton,style:t?{}:{opacity:0,cursor:"default"}},s.a.createElement(A.c,null)),s.a.createElement("div",{className:this.props.classes.swatch,onClick:function(){return e.handleClick()}},s.a.createElement("div",{className:this.props.classes.color,style:{background:t}})),this.state.displayColorPicker?s.a.createElement("div",{className:this.props.classes.popover},s.a.createElement("div",{className:this.props.classes.cover,onClick:function(){return e.handleClose()}}),s.a.createElement(P.ChromePicker,{color:this.state.color,onChangeComplete:function(t){return e.handleChange(t)}})):null)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return a.getColor(e.color)!==a.getColor(t.color)?{color:e.color}:null}},{key:"getColor",value:function(e){return e&&"object"===typeof e?e.rgb?"rgba("+e.rgb.r+","+e.rgb.g+","+e.rgb.b+","+e.rgb.a+")":"rgba("+e.r+","+e.g+","+e.b+","+e.a+")":e||""}}]),a}(s.a.Component),H=Object(h.a)((function(e){return{color:{width:36,height:14,borderRadius:2},delButton:{marginTop:16},swatch:{marginTop:16,padding:5,background:"#fff",borderRadius:1,boxShadow:"0 0 0 1px rgba(0,0,0,.1)",display:"inline-block",cursor:"pointer",verticalAlign:"middle"},popover:{position:"absolute",zIndex:2},cover:{position:"fixed",top:0,right:0,bottom:0,left:0},textDense:{marginTop:0,marginBottom:0}}}))(R),J=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onAliveChanged=function(e,t){e===n.aliveId&&n.setState({isInstanceAlive:t&&t.val})},n.state={inAction:!1,toast:"",isInstanceAlive:!1,errorWithPercent:!1},n.aliveId="system.adapter.".concat(n.props.adapterName,".").concat(n.props.instance,".alive"),n.props.socket.getState(n.aliveId).then((function(e){return n.setState({isInstanceAlive:e&&e.val})})),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.props.socket.subscribeState(this.aliveId,this.onAliveChanged)}},{key:"componentWillUnmount",value:function(){this.props.socket.unsubscribeState(this.aliveId,this.onAliveChanged)}},{key:"renderToast",value:function(){var e=this;return this.state.toast?s.a.createElement(O.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:!0,autoHideDuration:6e3,onClose:function(){return e.setState({toast:""})},ContentProps:{"aria-describedby":"message-id"},message:s.a.createElement("span",{id:"message-id"},this.state.toast),action:[s.a.createElement(D.a,{key:"close","aria-label":"Close",color:"inherit",className:this.props.classes.close,onClick:function(){return e.setState({toast:""})}},s.a.createElement(A.b,null))]}):null}},{key:"render",value:function(){var e=this;return s.a.createElement("form",{className:this.props.classes.tab},s.a.createElement(L.a,{instance:this.props.instance,common:this.props.common,native:this.props.native,onError:function(t){return e.setState({errorText:t})},onLoad:this.props.onLoad}),s.a.createElement("div",{className:this.props.classes.column+" "+this.props.classes.columnSettings},s.a.createElement(x.a,{label:S.a.t("Max list length"),className:this.props.classes.input,value:this.props.native.maxLength,type:"number",inputProps:{min:1,max:1e3},onChange:function(t){return e.props.onChange("maxLength",t.target.value)},margin:"normal"}),s.a.createElement("br",null),s.a.createElement(x.a,{label:S.a.t("Date format"),className:this.props.classes.input,value:this.props.native.dateFormat,type:"text",onChange:function(t){return e.props.onChange("dateFormat",t.target.value)},margin:"normal"}),s.a.createElement(k.a,{variant:"contained",onClick:function(){return window.open("https://momentjs.com/docs/#/displaying/format/","momentHelp")}},s.a.createElement(A.e,null),S.a.t("Format description")),s.a.createElement("br",null),s.a.createElement(x.a,{label:S.a.t("Show absolute time after seconds"),className:this.props.classes.input,value:this.props.native.relativeTime,type:"number",inputProps:{min:0,max:14e4},onChange:function(t){return e.props.onChange("relativeTime",t.target.value)},helperText:S.a.t("All older entries will be shown with absolute time, newer with relative time"),margin:"normal"}),s.a.createElement("br",null),s.a.createElement(x.a,{label:S.a.t("Default event text for boolean"),className:this.props.classes.input,value:this.props.native.defaultBooleanText,type:"text",onChange:function(t){return e.props.onChange("defaultBooleanTextTrue",t.target.value)},margin:"normal"}),s.a.createElement("br",null),s.a.createElement(x.a,{label:S.a.t("Default text by TRUE"),className:this.props.classes.input,value:this.props.native.defaultBooleanTextTrue,type:"text",onChange:function(t){return e.props.onChange("defaultBooleanTextTrue",t.target.value)},margin:"normal"}),s.a.createElement(x.a,{label:S.a.t("Default text by FALSE"),className:this.props.classes.input,value:this.props.native.defaultBooleanTextFalse,type:"text",onChange:function(t){return e.props.onChange("defaultBooleanTextTrue",t.target.value)},margin:"normal"}),s.a.createElement("br",null),s.a.createElement(H,{color:this.props.native.defaultBooleanColorTrue,style:{width:300,display:"inline-block",marginRight:16},name:S.a.t("Default color by TRUE"),onChange:function(t){return e.setState({defaultBooleanColorTrue:t})}}),s.a.createElement(H,{color:this.state.defaultBooleanColorFalse,style:{width:300,display:"inline-block"},name:S.a.t("Default color by FALSE"),onChange:function(t){return e.setState({defaultBooleanColorFalse:t})}}),s.a.createElement("br",null),s.a.createElement(x.a,{label:S.a.t("Default event text for non boolean states"),className:this.props.classes.input,value:this.props.native.defaultNonBooleanText,type:"text",onChange:function(t){return e.props.onChange("defaultNonBooleanText",t.target.value)},margin:"normal"}),s.a.createElement("br",null),s.a.createElement(x.a,{label:S.a.t("Default event text for non boolean states"),className:this.props.classes.input,value:this.props.native.defaultNonBooleanText,type:"text",onChange:function(t){return e.props.onChange("defaultNonBooleanText",t.target.value)},margin:"normal"}),s.a.createElement("br",null),s.a.createElement(T.a,{className:this.props.classes.input},s.a.createElement(w.a,null,S.a.t("Language")),s.a.createElement(N.a,{value:this.props.native.language||"system",onChange:function(t){return e.props.onChange("language","system"===t.target.value?"":t.target.value)}},s.a.createElement(I.a,{value:"system"},S.a.t("System language")),s.a.createElement(I.a,{value:"en"},"English"),s.a.createElement(I.a,{value:"de"},"Deutsch"),s.a.createElement(I.a,{value:"ru"},"\u0440\u0443\u0441\u0441\u043a\u0438\u0439"),s.a.createElement(I.a,{value:"pt"},"Portugues"),s.a.createElement(I.a,{value:"nl"},"Nederlands"),s.a.createElement(I.a,{value:"fr"},"fran\xe7ais"),s.a.createElement(I.a,{value:"it"},"Italiano"),s.a.createElement(I.a,{value:"es"},"Espanol"),s.a.createElement(I.a,{value:"pl"},"Polski"),s.a.createElement(I.a,{value:"zh-cn"},"\u7b80\u4f53\u4e2d\u6587"))),s.a.createElement("br",null),s.a.createElement(F.a,{control:s.a.createElement(j.a,{checked:this.props.native.icons||!1,onChange:function(t){return e.props.onChange("icons",t.target.checked)}}),label:S.a.t("Show icons in the list")}),s.a.createElement(F.a,{control:s.a.createElement(j.a,{checked:this.props.native.duration||!1,onChange:function(t){return e.props.onChange("duration",t.target.checked)}}),label:S.a.t("Show duration in the list")})),this.renderToast())}}]),a}(n.Component),z=Object(h.a)((function(e){return{tab:{width:"100%",minHeight:"100%"},input:{minWidth:300,marginRight:e.spacing(2)},button:{marginRight:20,marginBottom:40},card:{maxWidth:345,textAlign:"center"},media:{height:180},column:{display:"inline-block",verticalAlign:"top",marginRight:20},columnLogo:{width:350,marginRight:0},columnSettings:{width:"calc(100% - 370px)"},cannotUse:{color:"red",fontWeight:"bold"},hintUnsaved:{fontSize:12,color:"red",fontStyle:"italic"}}}))(J),W=a(3),G=a(13),V=a(134),_=a(589),M=a(590),U=a(587),Y=a(588),q=a(585),X=a(586),K=a(602),$=a(211),Q=a(82),Z=a(185),ee=a(264),te=a(212),ae=a(591),ne=a(150),se=a(191),re=a.n(se),ie=a(114),oe=a.n(ie),le=a(262),ce=a(207),ue=a(208),de=a(209),pe=a(210),he=a(95),me=a.n(he),ge=a(148),fe=a.n(ge),ve=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={showTime:!1,event:"",val:"",ts:""},n}return Object(u.a)(a,[{key:"onOk",value:function(){var e={event:this.state.event};this.state.ts&&(e.ts=this.state.ts),this.state.val&&(parseFloat(this.state.val).toString()===this.state.val?e.val=parseFloat(this.state.val):"true"===this.state.val?e.val=!0:"false"===this.state.val?e.val=!1:e.val=this.state.val),this.props.onClose(e)}},{key:"render",value:function(){var e=this;return s.a.createElement(le.a,{open:!0,onClose:function(){return e.props.onClose()},"aria-labelledby":"form-dialog-title"},s.a.createElement(pe.a,{id:"form-dialog-title"},S.a.t("Add event")),s.a.createElement(ue.a,null,s.a.createElement(de.a,null,S.a.t("You can add event to table, e.g. some comment.")),s.a.createElement(x.a,{autoFocus:!0,margin:"dense",label:S.a.t("Event text"),className:this.props.classes.textField,value:this.state.event,onKeyUp:function(t){return 13===t.keyCode&&e.state.event&&(!e.state.showTime||e.state.ts)&&e.onOk()},onChange:function(t){return e.setState({event:t.target.value})},type:"text",fullWidth:!0}),s.a.createElement("br",null),s.a.createElement(x.a,{margin:"dense",label:S.a.t("Value"),value:this.state.val,onChange:function(t){return e.setState({val:t.target.value})},type:"text",className:this.props.classes.textField,helperText:S.a.t("optional"),fullWidth:!0}),s.a.createElement("br",null),s.a.createElement(F.a,{control:s.a.createElement(j.a,{checked:this.state.showTime,onChange:function(t){return e.setState({showTime:t.target.checked,ts:t.target.checked?(new Date).toISOString():""})}}),label:S.a.t("Set time")}),s.a.createElement("br",null),this.state.showTime?s.a.createElement(x.a,{label:S.a.t("Time"),type:"datetime-local",value:this.state.ts,onChange:function(t){return e.setState({ts:t.target.value})},className:this.props.classes.textField,InputLabelProps:{shrink:!0}}):null),s.a.createElement(ce.a,null,s.a.createElement(k.a,{onClick:function(){return e.props.onClose()},color:"primary"},s.a.createElement(me.a,{className:this.props.classes.buttonIcon}),S.a.t("Cancel")),s.a.createElement(k.a,{disabled:!this.state.event||this.state.showTime&&!this.state.ts,onClick:function(){return e.onOk()},color:"primary"},s.a.createElement(fe.a,{className:this.props.classes.buttonIcon}),S.a.t("Insert"))))}}]),a}(n.Component),be=Object(h.a)((function(e){return{textField:{},buttonIcon:{marginRight:e.spacing(1)}}}))(ve),Ee=a(36),Ce=a.n(Ee),ye=(a(492),a(493),a(494),a(495),a(496),a(497),a(252),a(498),a(499),a(500),a(584)),Se=a(598),xe=a(582),ke=a(583),Ne=a(32),we=a.n(Ne),Ie=a(186),Te=a.n(Ie),Oe=a(268),De=a.n(Oe),Fe=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={value:n.props.value||""},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return s.a.createElement(x.a,{margin:"dense",label:this.props.label||S.a.t("Icon"),value:this.state.value,onChange:function(t){return e.setState({value:t.target.value})},type:"text",className:this.props.classes.textField})}}]),a}(s.a.Component),je=Object(h.a)((function(e){return{textField:{},textFieldWithButton:{width:"calc(100% - 70px)"}}}))(Fe),Ae=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onStateChanged=function(e,t){n.setState({state:t||null})},n.state={id:n.props.id||"",type:"",unit:"",name:"",event:"",eventDefault:!0,states:null,color:"",icon:"",changesOnly:!0,showSelectId:!1,unknownId:!0,simulateState:"",exists:!1,confirmExit:!1,confirmRemove:!1},n.language=n.props.native.language||S.a.getLanguage(),Ce.a.locale("en"===n.language?"en-gb":n.language),n.textSwitchedOn=n.translate("switched on",n.language),n.textSwitchedOff=n.translate("switched off",n.language),n.textDeviceChangedStatus=n.translate("Device %n changed status:",n.language),n.namespace="".concat(n.props.adapterName,".").concat(n.props.instance),n.subscribed="",n.originalSettings={},n.props.socket.getSystemConfig().then((function(e){n.isFloatComma=e.common.isFloatComma,n.state.id?n.readSettings():n.setState({showSelectId:!0})})),n}return Object(u.a)(a,[{key:"addBooleanStates",value:function(e){var t,a=JSON.parse(JSON.stringify(e.states||[])),n=a.find((function(e){return"true"===e.val}));n?n.original="true":(n={val:"true",text:"default",color:"default",icon:"default",original:"true"},a.push(n),t=!0);var s=a.find((function(e){return"false"===e.val}));s?s.original="false":(s={val:"false",text:"default",color:"default",icon:"default",original:"false"},a.push(s),t=!0);var r="default"===n.text;return r!==n.defText&&(t=!0,n.defText=r),(r="default"===n.text?"":n.text)!==n.text&&(t=!0,n.text=r),(r="default"===n.color)!==n.defColor&&(t=!0,n.defColor=r),(r="default"===n.color?"":n.color)!==n.color&&(t=!0,n.color=r),(r="default"===n.icon)!==n.defIcon&&(t=!0,n.defIcon=r),(r="default"===n.icon?"":n.icon)!==n.icon&&(t=!0,n.icon=r),(r="default"===s.text)!==s.defText&&(t=!0,s.defText=r),(r="default"===s.text?"":s.text)!==s.text&&(t=!0,s.text=r),(r="default"===s.color)!==s.defColor&&(t=!0,s.defColor=r),(r="default"===s.color?"":s.color)!==s.color&&(t=!0,s.color=r),(r="default"===s.icon)!==s.defIcon&&(t=!0,s.defIcon=r),(r="default"===s.icon?"":s.icon)!==s.icon&&(t=!0,s.icon=r),!!t&&(e.states=a,!0)}},{key:"parseStates",value:function(e){if(e instanceof Array){var t={};return e.forEach((function(e,a){return t[a]=e})),t}return"object"!==typeof e?null:e}},{key:"addNumericStates",value:function(e,t){var a,n=JSON.parse(JSON.stringify(e.states||[]));return(t=this.parseStates(t))?(Object.keys(t).forEach((function(e){var s=n.find((function(t){return t.val===e}));s||(s={val:e,text:t[e],color:"",icon:""},n.push(s),a=!0)})),n.forEach((function(e){e.original!==t[e.val]&&(e.original=t[e.val],a=!0)})),!!a&&(e.states=n,!0)):!!e.states&&(e.states=null,!0)}},{key:"subscribe",value:function(){this.state.id!==this.subscribed&&(this.subscribed&&this.props.socket.unsubscribeState(this.subscribed,this.onStateChanged),this.state.type?(this.state.id&&this.props.socket.subscribeState(this.state.id,this.onStateChanged),this.subscribed=this.state.id):this.subscribed="")}},{key:"readSettings",value:function(e){var t=this;e=e||this.state.id,this.readTypeTimer&&clearTimeout(this.readTypeTimer),this.readTypeTimer=setTimeout((function(){return t.props.socket.getObject(e).then((function(e){var a={type:e&&e.common&&e.common.type||"",unknownId:!e||!e.common||!e.common.type,name:t.getName(e),unit:e&&e.common&&e.common.unit||""};if(e&&e.common&&e.common.custom&&e.common.custom[t.namespace]){var n=e.common.custom[t.namespace];a.exists=!0,a.event="default"===n.event?"":n.event,a.eventDefault="default"===n.event,a.icon=n.icon,a.color=n.color,a.states=n.states,"boolean"===a.type?(t.addBooleanStates(a),a.simulateState=!1):"number"===a.type&&e&&e.common&&e.common.states&&"object"===typeof e.common.states?(t.addNumericStates(a,e.common.states),a.simulateState=null):(a.states=null,a.simulateState=null)}else a.exists=!1,"boolean"===a.type?(t.addBooleanStates(a),a.simulateState=!1):"number"===a.type&&e&&e.common&&e.common.states&&"object"===typeof e.common.states?(t.addNumericStates(a,e.common.states),a.simulateState=null):(a.states=null,a.simulateState=null);t.setState(a,(function(){return t.originalSettings=t.getSettings()}))})).catch((function(e){return t.setState({type:"",unknownId:!0,name:"",unit:""})})).then((function(){t.readTypeTimer=null,t.subscribe()}))}),500)}},{key:"getName",value:function(e){var t=e.common.name;return"object"===typeof t&&(t=t[this.props.native.language]||t.en),t||e._id}},{key:"renderSelectId",value:function(){var e=this;return this.state.showSelectId?s.a.createElement(De.a,{statesOnly:!0,showExpertButton:!0,multiSelect:!1,notEditable:!0,dialogName:S.a.t("Define state ID for event list"),socket:this.props.socket,selected:this.state.id,themeName:this.props.themeName,themeType:this.props.themeType,onOk:function(t){return e.setState({id:t},(function(){return e.readSettings(t)}))},onClose:function(){return e.setState({showSelectId:!1})}}):null}},{key:"translate",value:function(e,t){if(t=t||S.a.lang,S.a.translations[t]){var a=S.a.translations[t][e]||S.a.translations.en[e];a&&(e=a)}return e}},{key:"getExampleColor",value:function(){var e="";if(this.state.states){var t=!(!this.state.state||!this.state.state.val);"boolean"===this.state.type&&this.state.simulateState?t=!t:"boolean"!==this.state.type&&null!==this.state.simulateState&&(t=this.state.simulateState),t=void 0===t||null===t?"":t.toString();var n=this.state.states.find((function(e){return e.val===t}));n&&n.defColor?e="true"===t?a.getColor(this.props.native.defaultBooleanColorTrue):a.getColor(this.props.native.defaultBooleanColorFalse):n&&n.color&&a.getColor(n.color)&&(e=a.getColor(n.color))}return e=e||this.state.color&&a.getColor(this.state.color)||""}},{key:"getExampleIcon",value:function(){var e=this.state.icon||"";if(this.state.states){var t=!(!this.state.state||!this.state.state.val);"boolean"===this.state.type&&this.state.simulateState?t=!t:"boolean"!==this.state.type&&null!==this.state.simulateState&&(t=this.state.simulateState),t=void 0===t||null===t?"":t.toString();var a=this.state.states.find((function(e){return e.val===t}));a.defIcon?e="true"===t?this.props.native.defaultBooleanIconTrue:this.props.native.defaultBooleanIconFalse:a&&a.icon&&(e=a.icon)}return e&&(e.startsWith("data:")||(e=e.includes(".")?"/adapter/"+this.state.id.split(".").shift()+"/"+e:"")),e}},{key:"getExampleText",value:function(){var e="",t=this.state.state?this.state.state.val:"boolean"!==this.state.type&&null;if(this.state.states){"boolean"===this.state.type&&this.state.simulateState?t=!t:"boolean"!==this.state.type&&null!==this.state.simulateState&&(t=this.state.simulateState),t=void 0===t||null===t?"":t.toString();var a=this.state.states.find((function(e){return e.val===t}));e="true"===t&&a?a.defText?this.props.native.defaultBooleanTextTrue||this.textSwitchedOn:a.text||this.textSwitchedOn:"false"===t&&a?a.defText?this.props.native.defaultBooleanTextFalse||this.textSwitchedOff:a.text||this.textSwitchedOff:a&&a.defText?"true"===t?this.props.native.defaultBooleanTextTrue:this.props.native.defaultBooleanTextFalse:a&&a.text?a.text:t}else null===t||void 0===t?e="null":"number"===typeof t?(e=t.toString(),this.isFloatComma&&(e=e.replace(".",","))):e=t.toString();return e||""}},{key:"buildExample",value:function(){var e,t="",a="",n=this.state.state&&this.state.state.ts?Ce()(new Date(this.state.state.ts)).format(this.props.native.dateFormat):this.props.native.dateFormat,s=this.getExampleText();if("boolean"===this.state.type){var r=!(!this.state.state||!this.state.state.val);this.state.simulateState&&(r=!r),!this.state.eventDefault&&!this.state.event&&r&&s?t=s:this.state.eventDefault||this.state.event||r||!s?(t=(t=(t="default"===this.state.event||this.state.eventDefault?this.props.native.defaultBooleanText||this.textDeviceChangedStatus:this.state.event).replace(/%u/g,this.state.unit||"")).replace(/%n/g,this.state.name||this.state.id),a=s||(r?this.textSwitchedOn:this.textSwitchedOff)):t=s}else t="default"===this.state.event?this.props.native.defaultNonBooleanText||this.textDeviceChangedStatus:this.state.event||this.textDeviceChangedStatus,""!==(a=s)&&this.state.unit&&(a+=this.state.unit),this.state.states&&(this.state.eventDefault||this.state.event||(t=a,a="")),t=(t=t.replace(/%u/g,this.state.unit||"")).replace(/%n/g,this.state.name||this.state.id);t.includes("%d")&&(e=this.duration2text(5e3),t=t.replace(/%d/g,e));return t.includes("%s")&&(t=t.replace(/%s/g,s),a=""),t=t.replace(/%t/g,this.state.state?Ce()(new Date(this.state.state.ts)).format(this.props.native.dateFormat):this.props.native.dateFormat),"".concat(n," | ").concat(t," | ").concat(a)}},{key:"getSettings",value:function(){var e={enabled:!0,event:this.state.eventDefault?"default":this.state.event,changesOnly:!!this.state.changesOnly};return this.state.color&&a.getColor(this.state.color)&&(e.color=a.getColor(this.state.color)),this.state.icon&&(e.icon=this.state.icon),this.state.states&&this.state.states.forEach((function(t){e.states=e.states||[];var n={val:t.val};"true"===t.val||"false"===t.val?(n.text=t.defText?"default":t.text||"",(t.defColor||t.color&&a.getColor(t.color))&&(n.color=t.defColor?"default":a.getColor(t.color)),(t.defIcon||t.icon)&&(n.icon=t.defIcon?"default":t.icon)):(n.text=t.text||"",t.color&&a.getColor(t.color)&&(n.color=a.getColor(t.color)),t.icon&&(n.icon=t.icon)),e.states.push(n)})),e}},{key:"duration2text",value:function(e,t){if(e<1e3)return"".concat(e).concat(t?" ":"").concat(S.a.t("ms"));if(e<9e4)return"".concat(this.isFloatComma?(Math.round(e/100)/10).toString().replace(".",","):(Math.round(e/100)/10).toString()).concat(t?" ":"").concat(S.a.t("seconds"));if(e<36e5)return"".concat(Math.floor(e/6e4)).concat(t?" ":"").concat(S.a.t("minutes")," ").concat(Math.round(e%6e4/1e3)).concat(t?" ":"").concat(S.a.t("seconds"));var a=Math.floor(e/36e5),n=Math.floor(e/6e4)%60,s=Math.round(Math.floor(e%6e4)/1e3);return"".concat(a).concat(t?" ":"").concat(S.a.t("hours")," ").concat(n).concat(t?" ":"").concat(S.a.t("minutes")," ").concat(s).concat(t?" ":"").concat(S.a.t("seconds"))}},{key:"writeSettings",value:function(e){var t=this;this.props.socket.getObject(this.state.id).then((function(a){a&&a.common?(a.common.custom=a.common.custom||{},a.common.custom[t.namespace]=t.getSettings(),t.props.socket.setObject(t.state.id,a).then((function(){return e&&e()}))):e&&e()}))}},{key:"removeSettings",value:function(e){var t=this;this.props.socket.getObject(this.state.id).then((function(a){a&&a.common&&a.common.custom&&a.common.custom[t.namespace]?(a.common.custom[t.namespace]=null,t.props.socket.setObject(t.state.id,a).then((function(){return e&&e()}))):e&&e()}))}},{key:"onClose",value:function(){this.state.id&&JSON.stringify(this.originalSettings)!==JSON.stringify(this.getSettings())?this.setState({confirmExit:!0}):this.props.onClose()}},{key:"renderConfirmExit",value:function(){var e=this;return this.state.confirmExit?s.a.createElement(oe.a,{title:S.a.t("Changes not saved."),text:S.a.t("All changes will be lost. Exit?"),ok:S.a.t("Yes"),cancel:S.a.t("No"),onClose:function(t){e.setState({confirmExit:!1}),t&&e.props.onClose()}}):null}},{key:"renderConfirmRemove",value:function(){var e=this;return this.state.confirmRemove?s.a.createElement(oe.a,{title:S.a.t("Settings will be erased."),text:S.a.t("The state will be removed from event list and all settings erased. Are you sure?"),ok:S.a.t("Remove from list"),cancel:S.a.t("Cancel"),onClose:function(t){e.setState({confirmRemove:!1}),t&&(e.removeSettings(),e.props.onClose())}}):null}},{key:"renderState",value:function(e,t){var a=this,n=this.state.states[e],r="true"===n.val||"false"===n.val;return s.a.createElement(Se.a,{key:n.val},s.a.createElement(xe.a,{expandIcon:s.a.createElement(we.a,null)},s.a.createElement(Q.a,{className:this.props.classes.heading},S.a.t("State")," ",s.a.createElement("b",null,"true"===n.original||"false"===n.original?"".concat(n.original.toUpperCase()).concat(n.text?" - "+n.text:""):"".concat(n.original,"(").concat(n.val,")").concat(n.text?" - "+n.text:"")))),s.a.createElement(ke.a,null,s.a.createElement(Z.a,{className:this.props.classes.paper},r?s.a.createElement(F.a,{control:s.a.createElement(j.a,{checked:n.defText,onChange:function(t){var n=JSON.parse(JSON.stringify(a.state.states));n[e].defText=t.target.checked,a.setState({states:n})}}),label:S.a.t("Use default text")}):null,r&&n.defText?null:s.a.createElement(x.a,{margin:"dense",label:S.a.t("Text"),value:n.text,classes:{root:this.props.classes.textDense},onChange:function(t){var n=JSON.parse(JSON.stringify(a.state.states));n[e].text=t.target.value,a.setState({states:n})},type:"text",className:this.props.classes.textField}),t?s.a.createElement("br",null):null,r?s.a.createElement(F.a,{control:s.a.createElement(j.a,{checked:n.defColor,onChange:function(t){var n=JSON.parse(JSON.stringify(a.state.states));n[e].defColor=t.target.checked,a.setState({states:n})}}),label:S.a.t("Use default color",n.val.toUpperCase())}):null,r&&n.defColor?null:s.a.createElement(H,{color:n.color,style:{width:250,display:"inline-block"},name:S.a.t("Color"),onChange:function(t){var n=JSON.parse(JSON.stringify(a.state.states));n[e].color=t,a.setState({states:n})}}),t?s.a.createElement("br",null):null,r?s.a.createElement(F.a,{control:s.a.createElement(j.a,{checked:n.defIcon,onChange:function(t){var n=JSON.parse(JSON.stringify(a.state.states));n[e].defIcon=t.target.checked,a.setState({states:n})}}),label:S.a.t("Use default icon",n.val.toUpperCase())}):null,r&&n.defIcon?null:s.a.createElement(je,{label:S.a.t("Icon"),socket:this.props.socket,value:n.icon,onChange:function(t){var n=JSON.parse(JSON.stringify(a.state.states));n[e].icon=t.target.value,a.setState({states:n})}}),t?s.a.createElement("br",null):null)))}},{key:"renderStateSettings",value:function(e){var t=this;return s.a.createElement(Se.a,null,s.a.createElement(xe.a,{expandIcon:s.a.createElement(we.a,null)},s.a.createElement(Q.a,{className:this.props.classes.heading},S.a.t("Event settings"))),s.a.createElement(ke.a,null,s.a.createElement(Z.a,{className:this.props.classes.paper},s.a.createElement(F.a,{control:s.a.createElement(j.a,{checked:this.state.eventDefault,onChange:function(e){return t.setState({eventDefault:e.target.checked})}}),label:S.a.t("Default text")}),e?s.a.createElement("br",null):null,this.state.eventDefault?null:s.a.createElement(x.a,{margin:"dense",label:S.a.t("Event text"),value:this.state.event,onChange:function(e){return t.setState({event:e.target.value})},type:"text",className:this.props.classes.textField,helperText:S.a.t("You can use patterns: %s - value, %u - unit, %n - name, %t - time, %d - duration"),fullWidth:!0}),s.a.createElement("br",null),s.a.createElement(H,{color:this.state.color,style:{width:250,display:"inline-block"},name:S.a.t("Event color"),onChange:function(e){return t.setState({color:e})}}),s.a.createElement("br",null),s.a.createElement(je,{socket:this.props.socket,label:S.a.t("Event icon"),value:this.state.icon,onChange:function(e){return t.setState({icon:e.target.value})}}))))}},{key:"render",value:function(){var e=this,t="xs"===this.props.width||"sm"===this.props.width||"md"===this.props.width;return s.a.createElement(le.a,{open:!0,onClose:function(){return e.onClose()},"aria-labelledby":"form-dialog-title",fullWidth:!0,maxWidth:"lg"},s.a.createElement(pe.a,{id:"form-dialog-title"},S.a.t("Add event")),s.a.createElement(ue.a,null,s.a.createElement(de.a,null,S.a.t("You can add state to the event list, so the changes will be monitored.")),s.a.createElement("div",{className:this.props.classes.field},s.a.createElement(x.a,{autoFocus:!0,margin:"dense",label:S.a.t("State ID"),error:!(!this.state.id||!this.state.unknownId),className:this.props.classes.textFieldWithButton,value:this.state.id,onChange:function(t){return e.setState({id:t.target.value},(function(){return e.readSettings()}))},type:"text",fullWidth:!0}),s.a.createElement(k.a,{style:{marginTop:8},variant:"contained",color:"secondary",onClick:function(){return e.setState({showSelectId:!0})}},"...")),this.state.id&&this.state.type?s.a.createElement(Z.a,{className:Object(W.a)(this.props.classes.paper,this.props.classes.examplePaper)},s.a.createElement("span",{className:this.props.classes.exampleTitle},S.a.t("Example event:")),s.a.createElement("span",{className:this.props.classes.exampleText,style:{color:this.getExampleColor()||void 0}},this.props.native.icon?s.a.createElement("img",{src:this.getExampleIcon(),alt:"event",className:this.props.classes.exampleIcon}):null,this.buildExample()),"boolean"===this.state.type?s.a.createElement(s.a.Fragment,null,s.a.createElement("br",null),s.a.createElement(F.a,{control:s.a.createElement(ye.a,{checked:!!this.state.simulateState,onChange:function(t){return e.setState({simulateState:t.target.checked})}}),label:S.a.t("Toggle state to simulate")})):null,"number"===this.state.type&&this.state.states?s.a.createElement(s.a.Fragment,null,s.a.createElement("br",null),s.a.createElement(T.a,{className:this.props.classes.formControl},s.a.createElement(w.a,null,S.a.t("Simulate value")),s.a.createElement(N.a,{value:null===this.state.simulateState?"_current_":this.state.simulateState,onChange:function(t){return e.setState({simulateState:"_current_"===t.target.value?null:t.target.value})}},s.a.createElement(I.a,{value:"_current_"},S.a.t("current")),this.state.states.map((function(e){return s.a.createElement(I.a,{value:e.val},e.original,"(",e.val,")")}))))):null):null,this.state.id&&this.state.type?s.a.createElement(s.a.Fragment,null,s.a.createElement("br",null),s.a.createElement(F.a,{control:s.a.createElement(j.a,{checked:this.state.changesOnly,onChange:function(t){return e.setState({changesOnly:t.target.checked})}}),label:S.a.t("Only changes")})):null,this.state.id?this.renderStateSettings():null,this.state.states?this.state.states.map((function(a,n){return e.renderState(n,t)})):null),s.a.createElement(ce.a,null,s.a.createElement(k.a,{onClick:function(){return e.props.onClose()}},s.a.createElement(me.a,{className:this.props.classes.buttonIcon}),S.a.t("Cancel")),this.state.exists?s.a.createElement(k.a,{disabled:!this.state.id||!this.state.type,onClick:function(){return e.setState({confirmRemove:!0})}},s.a.createElement(ne.a,{className:this.props.classes.buttonIcon}),S.a.t("Remove")):null,s.a.createElement(k.a,{disabled:!this.state.id||!this.state.type||this.state.exists&&JSON.stringify(this.originalSettings)===JSON.stringify(this.getSettings()),onClick:function(){return e.writeSettings((function(){return e.props.onClose()}))},color:"primary"},s.a.createElement(Te.a,{className:this.props.classes.buttonIcon}),this.state.exists?S.a.t("Update"):S.a.t("Add"))),this.renderSelectId(),this.renderConfirmExit(),this.renderConfirmRemove())}}],[{key:"getColor",value:function(e){return e&&"object"===typeof e?e.rgb?"rgba("+e.rgb.r+","+e.rgb.g+","+e.rgb.b+","+e.rgb.a+")":"rgba("+e.r+","+e.g+","+e.b+","+e.a+")":e||""}}]),a}(n.Component),Be=Object(V.a)()(Object(h.a)((function(e){return{textField:{width:250,marginRight:e.spacing(1)},textFieldWithButton:{width:"calc(100% - 70px)"},examplePaper:{marginBottom:e.spacing(2),background:"dark"===e.palette.type?"#5f5f5f":"#d8d8d8"},exampleTitle:{fontWeight:"bold"},exampleText:{marginLeft:e.spacing(1),fontStyle:"italic",fontSize:20},exampleIcon:{maxWidth:32,maxHeight:32,marginRight:e.spacing(1)},textDense:{marginTop:0,marginBottom:0},paper:{marginBottom:e.spacing(1),padding:e.spacing(1),width:"100%"},buttonIcon:{marginRight:e.spacing(1)},formControl:{width:200}}}))(Ae)),Le=a(250),Pe=a(190),Re=a(256),He=a(258),Je=a(187),ze=a.n(Je),We=a(65),Ge=a.n(We);var Ve=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={selected:"",ids:[],reading:!0,filter:""},n.promises={},n.readIds().then((function(e){return n.setState({ids:e})})),n}return Object(u.a)(a,[{key:"readIds",value:function(){var e=this;return new Promise((function(t,a){e.props.socket.getRawSocket().emit("getObjectView","custom","state",{startkey:"",endkey:"\u9999"},(function(n,s){if(n)a(n);else{var r="".concat(e.props.adapterName,".").concat(e.props.instance||0),i=[];if(s&&s.rows)for(var o=0;o<s.rows.length;o++){s.rows[o].value[r]&&i.push(s.rows[o].id)}t(i)}}))}))}},{key:"getObject",value:function(e){var t=this;return this.props.socket.getObject(e).then((function(e){return t.setState({[e._id]:e})}))}},{key:"renderListItem",value:function(e,t){var a=this,n=this.state[e];if(n){var r=Ge.a.getObjectNameFromObj(n,null,{language:this.state.lang})||n;if(t&&!e.toLowerCase().includes(t)&&!r.toLowerCase().includes(t))return null;var i=function(e,t){t=t||".";var a="",n=e._id.replace("system.adapter.").split(".")[0],s=e&&e.common&&e.common.icon;if(s)if(s.startsWith("data:image/"))a=s;else{if(!s.includes("."))return null;a=t+"/adapter/"+n+"/"+s}return a||null}(n);return s.a.createElement(Pe.a,{button:!0,onClick:function(){return a.props.onClose(e)},key:e},s.a.createElement(Re.a,null,i?s.a.createElement("img",{src:i,className:this.props.classes.icon,alt:"state"}):s.a.createElement("div",{className:this.props.classes.emptyIcon},"\xa0")),s.a.createElement(He.a,{primary:r,secondary:e!==r?e:"",classes:{primary:this.props.classes.listPrimary,secondary:this.props.classes.listSecondary}}))}return this.promises[e]=this.promises[e]||this.getObject(e),t&&!e.toLowerCase().includes(t)?null:s.a.createElement(Pe.a,{button:!0,onClick:function(){return a.props.onClose(e)},key:e},s.a.createElement(Re.a,null,s.a.createElement("div",{className:this.props.classes.emptyIcon},"\xa0")),s.a.createElement(He.a,{primary:e,classes:{primary:this.props.classes.listPrimary}}))}},{key:"render",value:function(){var e=this,t=this.state.filter.toLowerCase();return s.a.createElement(le.a,{open:!0,fullWidth:!0,maxWidth:"md",onClose:function(){return e.props.onClose()}},s.a.createElement(pe.a,null,S.a.t("Select state"),s.a.createElement(x.a,{label:S.a.t("Filter"),InputLabelProps:{shrink:!0},InputProps:{endAdornment:this.state.searchedValue?s.a.createElement(D.a,{onClick:function(){return e.setState({searchedValue:""})}},s.a.createElement(ze.a,null)):void 0},autoFocus:!0,value:this.state.filter,onChange:function(t){return e.setState({filter:t.target.value})},fullWidth:!0,size:"small"})),s.a.createElement(ue.a,{className:this.props.classes.dialogContent},s.a.createElement(Le.a,{dense:!0},!t&&s.a.createElement(Pe.a,{button:!0,onClick:function(){return e.props.onClose(!0)}},s.a.createElement(Re.a,null,s.a.createElement(fe.a,null)),s.a.createElement(He.a,{primary:S.a.t("Add new state"),classes:{primary:this.props.classes.newState}})),this.state.ids.map((function(a){return e.renderListItem(a,t)})))),s.a.createElement(ce.a,null,s.a.createElement(k.a,{onClick:function(){return e.props.onClose()},color:"primary"},s.a.createElement(me.a,{className:this.props.classes.buttonIcon}),S.a.t("Cancel"))))}}]),a}(n.Component),_e=Object(h.a)((function(e){return{textField:{},buttonIcon:{marginRight:e.spacing(1)},icon:{width:32,maxHeight:32},emptyIcon:{marginRight:e.spacing(1)},listPrimary:{},listSecondary:{opacity:.8,fontStyle:"italic",fontSize:"smaller"},newState:{color:e.palette.primary.main,fontSize:"greater",fontWeight:"bold"}}}))(Ve),Me=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).onStateChanged=function(e,t){if(e===n.aliveId&&n.setState({isInstanceAlive:t&&t.val}),e===n.triggerPDFId)n.setState({pdfInGeneration:t&&t.val});else if(e===n.eventListId){var a;try{a=t&&t.val?JSON.parse(t.val):[]}catch(o){a=[]}n.state.eventRawList&&a.forEach((function(e){var t=n.state.eventRawList.find((function(t){return t.ts===e._id}));t&&(e.stateId=t.id)})),n.setState({eventList:a})}else if(e===n.eventRawListId){var s;try{s=t&&t.val?JSON.parse(t.val):[]}catch(o){s=[]}var r=null;n.state.eventList&&n.state.eventList.forEach((function(e,t){if(!e.stateId){var a=s.find((function(t){return t.ts===e._id}));a&&((r=r||JSON.parse(JSON.stringify(n.state.eventList)))[t].stateId=a.id)}}));var i={eventRawList:s};r&&(i.eventList=r),n.setState(i)}},n.onRequestSort=function(e,t){var a=n.state.orderBy===t&&"asc"===n.state.order;n.setState({order:a?"desc":"asc",orderBy:t})};var s=window.localStorage.getItem("".concat(n.props.adapterName,"-").concat(n.props.instance||0,"-adapter.editEnabled"))||null,r=void 0===e.editAvailable||e.editAvailable;return r?n.props.showEditButton&&null!==s?"true"===s?s=!0:"false"===s&&(s=!1):s=void 0===e.editEnabled||e.editEnabled:s=!1,n.state={toast:"",isInstanceAlive:!1,eventList:!1,eventRawList:!1,order:"desc",orderBy:"ts",selected:[],showDeleteConfirm:!1,showAddIdDialog:!1,showAddEventDialog:!1,selectedId:"",editEnabled:s,editAvailable:r,pdfInGeneration:!1},n.aliveId="system.adapter.".concat(n.props.adapterName,".").concat(n.props.instance,".alive"),n.eventListId="".concat(n.props.adapterName,".").concat(n.props.instance,".eventJSONList"),n.eventRawListId="".concat(n.props.adapterName,".").concat(n.props.instance,".eventListRaw"),n.triggerPDFId="".concat(n.props.adapterName,".").concat(n.props.instance,".triggerPDF"),n.headCells=[{id:"ts",label:S.a.t("Time"),align:"right"},{id:"event",label:S.a.t("Event"),align:"center"},{id:"val",label:S.a.t("Value"),align:"left"}],n}return Object(u.a)(a,[{key:"readStatus",value:function(e){var t=this;this.props.socket.getState(this.aliveId).then((function(a){return t.props.socket.getState(t.eventListId).then((function(n){return t.props.socket.getState(t.eventRawListId).then((function(s){var r,i;try{r=n&&n.val?JSON.parse(n.val):[]}catch(o){r=[]}try{i=s&&s.val?JSON.parse(s.val):[]}catch(o){i=[]}r.forEach((function(e){var t=i.find((function(t){return t.ts===e._id}));t&&(e.stateId=t.id)})),t.setState({isInstanceAlive:a&&a.val,eventList:r,eventRawList:i},(function(){return e&&e()}))}))}))}))}},{key:"componentDidMount",value:function(){var e=this;this.readStatus((function(){e.props.socket.subscribeState(e.aliveId,e.onStateChanged),e.props.socket.subscribeState(e.eventListId,e.onStateChanged),e.props.socket.subscribeState(e.eventRawListId,e.onStateChanged),e.props.socket.subscribeState(e.triggerPDFId,e.onStateChanged)}))}},{key:"componentWillUnmount",value:function(){this.props.socket.unsubscribeState(this.aliveId,this.onStateChanged),this.props.socket.unsubscribeState(this.eventListId,this.onStateChanged),this.props.socket.unsubscribeState(this.eventRawListId,this.onStateChanged),this.props.socket.unsubscribeState(this.triggerPDFId,this.onStateChanged)}},{key:"renderToast",value:function(){var e=this;return this.state.toast?s.a.createElement(O.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:!0,autoHideDuration:6e3,onClose:function(){return e.setState({toast:""})},ContentProps:{"aria-describedby":"message-id"},message:s.a.createElement("span",{id:"message-id"},this.state.toast),action:[s.a.createElement(D.a,{key:"close","aria-label":"Close",color:"inherit",className:this.props.classes.close,onClick:function(){return e.setState({toast:""})}},s.a.createElement(A.b,null))]}):null}},{key:"renderHeader",value:function(){var e=this;return s.a.createElement(q.a,null,s.a.createElement(X.a,null,this.state.isInstanceAlive&&this.state.editAvailable&&this.state.editEnabled&&s.a.createElement(U.a,{padding:"checkbox"},s.a.createElement(j.a,{indeterminate:!!this.state.selected.length&&this.state.selected.length<this.state.eventList.length,checked:this.state.eventList.length>0&&this.state.selected.length===this.state.eventList.length,disabled:!this.state.eventList.length,onChange:function(t){if(t.target.checked){var a=e.state.eventList.map((function(e){return e._id})),n=1===a.length?e.state.eventList.find((function(e){return e._id===a[0]})).stateId:"";e.setState({selected:a,selectedId:n})}else e.setState({selected:[],selectedId:""})},inputProps:{"aria-label":"select all desserts"}})),this.props.native.icons?s.a.createElement(U.a,{component:"th",className:this.props.classes.tdIcons,align:"left",padding:"none"}):null,this.headCells.map((function(t){return s.a.createElement(U.a,{key:t.id,className:e.props.classes["td"+t.id[0].toUpperCase()+t.id.substring(1)],align:t.align,padding:"none",component:"th",sortDirection:e.state.orderBy===t.id&&e.state.order},s.a.createElement(K.a,{active:e.state.orderBy===t.id,direction:e.state.orderBy===t.id?e.state.order:"asc",onClick:(a=t.id,function(t){return e.onRequestSort(t,a)})},t.label,e.state.orderBy===t.id?s.a.createElement("span",{className:e.props.classes.visuallyHidden},"desc"===e.state.order?S.a.t("sorted descending"):S.a.t("sorted ascending")):null));var a})),this.props.native.duration?s.a.createElement(U.a,{className:this.props.classes.tdDuration,component:"th",padding:"none",align:"right"},S.a.t("Duration")):null,this.state.editAvailable&&this.state.editEnabled&&s.a.createElement(U.a,{className:this.props.classes.tdID,align:"left"},"State ID"),this.state.editAvailable&&this.state.editEnabled&&s.a.createElement(U.a,{className:this.props.classes.tdEdit,align:"left"})))}},{key:"triggerPdf",value:function(){this.state.isInstanceAlive&&this.props.socket.sendTo(this.props.adapterName+"."+this.props.instance,"pdf",this.props.native.pdfSettings).then((function(){var e;(e=window.location.pathname.includes("adapter/")?window.open("/files/eventlist/report.pdf?q="+Date.now(),"pdf"):window.open("/eventlist/report.pdf?q="+Date.now(),"pdf"))&&e.focus()}))}},{key:"renderToolbar",value:function(){var e=this,t="xs"===this.props.width||"sm"===this.props.width;return s.a.createElement($.a,{className:Object(W.a)(this.props.classes.toolbarRoot,this.state.selected.length&&this.props.classes.toolbarHighlight)},this.state.isInstanceAlive&&this.state.editAvailable&&this.state.editEnabled&&this.state.selected.length?s.a.createElement(Q.a,{className:this.props.classes.toolbarTitle,color:"inherit",variant:"subtitle1",component:"div"},this.state.selected.length," ",S.a.t("selected")):s.a.createElement(Q.a,{className:this.props.classes.toolbarTitle,variant:"h6",id:"tableTitle",component:"div"},s.a.createElement("span",null,S.a.t("Event list")),s.a.createElement("span",{className:this.props.classes.instanceNotOnline},this.state.isInstanceAlive?"":S.a.t("(Instance not running)"))),this.state.editAvailable&&this.state.editEnabled&&this.state.selected.length?s.a.createElement(s.a.Fragment,null,s.a.createElement(ee.a,{title:S.a.t("Delete")},s.a.createElement(D.a,{"aria-label":"delete",onClick:function(){return e.setState({showDeleteConfirm:!0})}},s.a.createElement(re.a,null))),this.state.selectedId?s.a.createElement(ee.a,{title:S.a.t("Edit settings for state")},s.a.createElement(D.a,{"aria-label":"edit",onClick:function(){return e.setState({showAddIdDialog:e.state.selectedId})}},s.a.createElement(A.d,null))):null):s.a.createElement(s.a.Fragment,null,this.state.editAvailable&&this.state.editEnabled&&s.a.createElement(ee.a,{title:S.a.t("Add state to event list"),className:this.props.classes.toolbarButton},s.a.createElement(te.a,{variant:"extended",size:"small","aria-label":"add",color:"secondary",onClick:function(){return e.setState({selectStateShow:!0})}},s.a.createElement("div",{className:Object(W.a)(!t&&this.props.classes.toolbarButtonText)},s.a.createElement(A.d,{style:{verticalAlign:"middle",marginRight:8}}),t?null:s.a.createElement("span",{style:{verticalAlign:"middle"}},S.a.t("States"))))),this.state.editAvailable&&this.state.editEnabled&&s.a.createElement(ee.a,{title:S.a.t("Insert custom event into list"),className:this.props.classes.toolbarButton},s.a.createElement("span",null,s.a.createElement(te.a,{variant:"extended","aria-label":"add",size:"small",color:"primary",disabled:!this.state.isInstanceAlive,onClick:function(){return e.setState({showAddEventDialog:!0})}},s.a.createElement("div",{className:Object(W.a)(!t&&this.props.classes.toolbarButtonText)},s.a.createElement(A.a,{style:{verticalAlign:"middle"}}),t?null:s.a.createElement("span",{style:{verticalAlign:"middle"}},S.a.t("Custom Event")))))),this.state.editAvailable&&this.props.showEditButton&&s.a.createElement(ee.a,{title:S.a.t("Edit mode"),className:this.props.classes.toolbarButton},s.a.createElement(te.a,{variant:"extended","aria-label":"enable-edit",size:"small",style:this.state.editEnabled?{background:"red"}:{},onClick:function(){window.localStorage.setItem("".concat(e.props.adapterName,"-").concat(e.props.instance||0,"-adapter.editEnabled"),e.state.editEnabled?"false":"true"),e.setState({editEnabled:!e.state.editEnabled})}},s.a.createElement(A.d,null))),this.props.native.pdfButton&&s.a.createElement(ee.a,{title:S.a.t("Generate PDF file"),className:this.props.classes.toolbarButton},s.a.createElement("span",null,s.a.createElement(te.a,{variant:"extended","aria-label":"generate-pdf",size:"small",disabled:!this.state.isInstanceAlive||this.state.pdfInGeneration,onClick:function(){return e.triggerPdf()}},s.a.createElement(ne.b,null)))),s.a.createElement(ee.a,{title:S.a.t("Refresh list"),className:this.props.classes.toolbarButton},s.a.createElement(te.a,{variant:"extended","aria-label":"refresh",size:"small",onClick:function(){return e.readStatus()}},s.a.createElement(A.g,null)))))}},{key:"stableSort",value:function(e,t){var a=e.map((function(e,t){return[e,t]}));return a.sort((function(e,a){var n=t(e[0],a[0]);return 0!==n?n:e[1]-a[1]})),a.map((function(e){return e[0]}))}},{key:"descendingComparator",value:function(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}},{key:"getComparator",value:function(e,t){var a=this;return"desc"===e?function(e,n){return a.descendingComparator(e,n,"ts"===t?"_id":t)}:function(e,n){return-a.descendingComparator(e,n,"ts"===t?"_id":t)}}},{key:"handleClick",value:function(e){var t=this.state.selected.indexOf(e),a=[],n="";-1===t?a=a.concat(this.state.selected,e):0===t?a=a.concat(this.state.selected.slice(1)):t===this.state.selected.length-1?a=a.concat(this.state.selected.slice(0,-1)):t>0&&(a=a.concat(this.state.selected.slice(0,t),this.state.selected.slice(t+1))),1===a.length&&(n=this.state.eventList.find((function(e){return e._id===a[0]})).stateId),this.setState({selected:a,selectedId:n})}},{key:"deleteEntries",value:function(e){var t=this;this.props.socket.getState("".concat(this.props.adapterName,".").concat(this.props.instance,".eventListRaw")).then((function(a){var n;try{n=a&&a.val?JSON.parse(a.val):[]}catch(s){n=[]}n=n.filter((function(e){return!t.state.selected.includes(e.ts)})),t.props.socket.setState("".concat(t.props.adapterName,".").concat(t.props.instance,".eventListRaw"),JSON.stringify(n)).then((function(){return t.setState({selected:[],selectedId:""},(function(){return e&&e()}))}))}))}},{key:"renderSelectState",value:function(){var e=this;return this.state.selectStateShow?s.a.createElement(_e,{socket:this.props.socket,adapterName:this.props.adapterName,instance:this.props.instance,onClose:function(t){t?e.setState({showAddIdDialog:t,selectStateShow:!1}):e.setState({selectStateShow:!1})}}):null}},{key:"renderList",value:function(){var e=this;return s.a.createElement(Y.a,{className:this.props.classes.tableContainer},s.a.createElement(_.a,{className:this.props.classes.table,size:"small"},this.renderHeader(),s.a.createElement(M.a,null,this.stableSort(this.state.eventList,this.getComparator(this.state.order,this.state.orderBy)).map((function(t,a){var n=e.state.selected.includes(t._id),r="enhanced-table-checkbox-".concat(a);return s.a.createElement(X.a,{hover:!0,onClick:function(){return e.handleClick(t._id)},style:t._style||void 0,role:"checkbox","aria-checked":n,tabIndex:-1,key:t._id,selected:n},e.state.isInstanceAlive&&e.state.editAvailable&&e.state.editEnabled&&s.a.createElement(U.a,{padding:"checkbox"},s.a.createElement(j.a,{checked:n,inputProps:{"aria-labelledby":r}})),e.props.native.icons?s.a.createElement(U.a,{style:t._style||void 0,className:e.props.classes.tdIcons,component:"td",padding:"none",align:"center"},t.icon?s.a.createElement("img",{src:t.icon,width:28,height:28,alt:""}):null):null,s.a.createElement(U.a,{style:t._style||void 0,className:e.props.classes.tdTs,scope:"row",padding:"none",align:"right"},t.ts),s.a.createElement(U.a,{style:t._style||void 0,className:e.props.classes.tdEvent,align:"right"},t.event),s.a.createElement(U.a,{style:t._style||void 0,className:e.props.classes.tdVal,align:"left"},void 0===t.val?"":t.val.toString()),e.props.native.duration?s.a.createElement(U.a,{style:t._style||void 0,className:e.props.classes.tdDuration,component:"td",padding:"none",align:"right"},t.duration||""):null,e.state.editAvailable&&e.state.editEnabled&&s.a.createElement(U.a,{className:e.props.classes.tdID,align:"left"},t.stateId),e.state.editAvailable&&e.state.editEnabled&&s.a.createElement(U.a,{className:e.props.classes.tdEdit,align:"left"},t.stateId?s.a.createElement(ee.a,{title:S.a.t("Edit settings for state"),className:e.props.classes.toolbarButton},s.a.createElement(D.a,{className:e.props.classes.editButton,onClick:function(a){a.stopPropagation(),e.setState({showAddIdDialog:t.stateId})}},s.a.createElement(A.d,null))):null))})))))}},{key:"renderConfirmDialog",value:function(){var e=this;return this.state.showDeleteConfirm?s.a.createElement(oe.a,{title:S.a.t("Please confirm"),text:S.a.t("Are you sure to delete events from list?"),ok:S.a.t("Ok"),cancel:S.a.t("Cancel"),icon:s.a.createElement(A.f,null),onClose:function(t){return e.setState({showDeleteConfirm:!1},(function(){return t&&e.deleteEntries()}))}}):null}},{key:"renderAddEventDialog",value:function(){var e=this;return this.state.showAddEventDialog?s.a.createElement(be,{onClose:function(t){e.setState({showAddEventDialog:!1},(function(){return t&&e.props.socket.sendTo("".concat(e.props.adapterName,".").concat(e.props.instance),"insert",t)}))}}):null}},{key:"renderAddIdDialog",value:function(){var e=this;return this.state.showAddIdDialog?s.a.createElement(Be,{instance:this.props.instance,adapterName:this.props.adapterName,themeName:this.props.themeName,themeType:this.props.themeType,socket:this.props.socket,native:this.props.native,id:"string"===typeof this.state.showAddIdDialog?this.state.showAddIdDialog:"",onClose:function(t){e.setState({showAddIdDialog:!1},(function(){return t&&e.props.socket.sendTo("".concat(e.props.adapterName,".").concat(e.props.instance),"insert",t)}))}}):null}},{key:"render",value:function(){return s.a.createElement(Z.a,{className:this.props.classes.tab},this.renderToolbar(),this.state.eventList?this.renderList():s.a.createElement(ae.a,null),this.renderToast(),this.renderConfirmDialog(),this.renderAddEventDialog(),this.renderAddIdDialog(),this.renderSelectState())}}]),a}(n.Component),Ue=Object(V.a)()(Object(h.a)((function(e){return{tab:{width:"100%",height:"100%",overflow:"hidden"},instanceNotOnline:{color:"#883333",marginLeft:e.spacing(1)},toolbarRoot:{paddingLeft:e.spacing(2),paddingRight:e.spacing(1)},toolbarHighlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(G.i)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},toolbarTitle:{flex:"1 1 100%"},toolbarButton:{marginRight:e.spacing(1)},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},tableContainer:{height:"100%",overflow:"auto"},table:{width:"auto"},tdIcons:{textAlign:"right",marginRight:e.spacing(1),marginTop:2},tdTs:{paddingRight:e.spacing(1)},tdEvent:{paddingRight:e.spacing(1)},tdVal:{},tdDuration:{},tdID:{opacity:.3},tdEdit:{},editButton:{height:16,opacity:.3,"&:hover":{opacity:1}},toolbarButtonText:{whiteSpace:"nowrap",marginLeft:16,marginRight:16,lineHeight:24,display:"inline-block"}}}))(Me)),Ye=a(153),qe=a(152),Xe=a.n(qe),Ke=a(253),$e={enabledTime:!0,enabledValue:!0,enabledDuration:!0,widthTime:130,widthEvent:200,widthValue:110,widthDuration:100,textTime:"Time",textEvent:"Event",textValue:"Value",textDuration:"Duration",paddingLeft:60,paddingTopFirst:120,paddingTop:60,pageWidth:510,pageHeight:740,textColor:"#000000",fontSize:10,colorLineOdd:"#E8E8E8",colorLineEven:"#FFFFFF",lineHeight:18,colorHeaderBackground:"#888888",colorHeader:"#FFFFFF",fontSizeHeader:13,enabledHeader:!0,titleColor:"#000000",titleText:"Event list",titleFontSize:18,pageNumberOffsetX:50,pageNumberOffsetY:10,pageNumberFontSize:10,pageNumberColor:"#000000",pageNumberEnabled:!0,margins:{top:30,bottom:30,left:30,right:30}},Qe=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).onStateChanged=function(e,t){e===n.aliveId&&n.state.isInstanceAlive!==(!!t&&t.val)&&n.setState({isInstanceAlive:t&&t.val},(function(){return n.triggerPdf()})),e===n.triggerPDFId&&n.setState({pdfInGeneration:t&&t.val})};var s=window.localStorage.getItem("eventlist.app.expanded")||"[]";try{s=JSON.parse(s)}catch(r){}return n.state={isInstanceAlive:!1,pdfInGeneration:!1,random:0,expanded:s},n.aliveId="system.adapter.".concat(n.props.adapterName,".").concat(n.props.instance,".alive"),n.triggerPDFId="".concat(n.props.adapterName,".").concat(n.props.instance,".triggerPDF"),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.props.socket.subscribeState(this.aliveId,this.onStateChanged),this.props.socket.subscribeState(this.triggerPDFId,this.onStateChanged)}},{key:"componentWillUnmount",value:function(){this.props.socket.unsubscribeState(this.aliveId,this.onStateChanged),this.props.socket.unsubscribeState(this.triggerPDFId,this.onStateChanged)}},{key:"triggerPdf",value:function(){var e=this;this.state.isInstanceAlive&&!this.state.pdfInGeneration&&(this.triggerTimer&&clearTimeout(this.triggerTimer),this.triggerTimer=setTimeout((function(){e.triggerTimer=null,e.setState({pdfInGeneration:!0}),e.props.socket.sendTo(e.props.adapterName+"."+e.props.instance,"pdf",e.props.native.pdfSettings).then((function(){return e.setState({pdfInGeneration:!1,random:e.state.random+1},(function(){return setTimeout((function(){e.lastElement&&(e.lastElement.focus(),e.lastElement=null)}))}))}))}),1e3))}},{key:"onChange",value:function(e,t,a){var n=this;a&&(this.lastElement=a.target),this.props.onChange("pdfSettings."+e,t,(function(){return n.triggerPdf()}))}},{key:"onExpand",value:function(e,t){var a=Object(Ye.a)(this.state.expanded);if(t)!a.includes(e)&&a.push(e);else{var n=a.indexOf(e);-1!==n&&a.splice(n,1)}window.localStorage.setItem("eventlist.app.expanded",JSON.stringify(a)),this.setState({expanded:a})}},{key:"renderSettingsTime",value:function(e){var t=this;return s.a.createElement(Se.a,{expanded:e.enabledTime&&this.state.expanded.includes("enabledTime"),onChange:function(e,a){return t.onExpand("enabledTime",a)}},s.a.createElement(xe.a,{expandIcon:e.enabledTime?s.a.createElement(we.a,null):null,classes:{content:this.props.classes.accordionContent}},s.a.createElement(F.a,{key:"enabledTime",onFocus:function(e){return e.stopPropagation()},onClick:function(e){return e.stopPropagation()},control:s.a.createElement(j.a,{checked:e.enabledTime||!1,onChange:function(e){return t.onChange("enabledTime",e.target.checked,e)}}),label:S.a.t("Show time")})),!!e.enabledTime&&s.a.createElement(ke.a,null,s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"widthTime",type:"number",className:this.props.classes.field,label:S.a.t("Column width"),value:e.widthTime,onChange:function(e){return t.onChange("widthTime",e.target.value,e)}}),!!e.enabledHeader&&s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"textTime",type:"text",className:this.props.classes.field,label:S.a.t("Header text"),value:e.textTime,onChange:function(e){return t.onChange("textTime",e.target.value,e)}})))}},{key:"renderSettingsEvent",value:function(e){var t=this;return s.a.createElement(Se.a,{expanded:this.state.expanded.includes("enabledEvent"),onChange:function(e,a){return t.onExpand("enabledEvent",a)}},s.a.createElement(xe.a,{expandIcon:s.a.createElement(we.a,null),classes:{content:Object(W.a)(this.props.classes.accordionContent,this.props.classes.noCheckbox)}},S.a.t("Event")),s.a.createElement(ke.a,null,s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"widthEvent",type:"number",className:this.props.classes.field,label:S.a.t("Column width"),value:e.widthEvent,onChange:function(e){return t.onChange("widthEvent",e.target.value,e)}}),!!e.enabledHeader&&s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"textEvent",type:"text",className:this.props.classes.field,label:S.a.t("Header text"),value:e.textEvent,onChange:function(e){return t.onChange("textEvent",e.target.value,e)}})))}},{key:"renderSettingsValue",value:function(e){var t=this;return s.a.createElement(Se.a,{expanded:e.enabledValue&&this.state.expanded.includes("enabledValue"),onChange:function(e,a){return t.onExpand("enabledValue",a)}},s.a.createElement(xe.a,{expandIcon:e.enabledValue?s.a.createElement(we.a,null):null,classes:{content:this.props.classes.accordionContent}},s.a.createElement(F.a,{onFocus:function(e){return e.stopPropagation()},onClick:function(e){return e.stopPropagation()},key:"enabledValue",control:s.a.createElement(j.a,{checked:e.enabledValue||!1,onChange:function(e){return t.onChange("enabledValue",e.target.checked,e)}}),label:S.a.t("Show value")})),!!e.enabledValue&&s.a.createElement(ke.a,null,s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"widthValue",type:"number",className:this.props.classes.field,label:S.a.t("Column width"),value:e.widthValue,onChange:function(e){return t.onChange("widthValue",e.target.value,e)}}),!!e.enabledHeader&&s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"textValue",type:"text",className:this.props.classes.field,label:S.a.t("Header text"),value:e.textTime,onChange:function(e){return t.onChange("textValue",e.target.value,e)}})))}},{key:"renderSettingsDuration",value:function(e){var t=this;return s.a.createElement(Se.a,{expanded:e.enabledDuration&&this.state.expanded.includes("enabledDuration"),onChange:function(e,a){return t.onExpand("enabledDuration",a)}},s.a.createElement(xe.a,{expandIcon:e.enabledDuration?s.a.createElement(we.a,null):null,classes:{content:this.props.classes.accordionContent}},s.a.createElement(F.a,{onFocus:function(e){return e.stopPropagation()},onClick:function(e){return e.stopPropagation()},key:"enabledDuration",control:s.a.createElement(j.a,{checked:e.enabledDuration||!1,onChange:function(e){t.onChange("enabledDuration",e.target.checked,e)}}),label:S.a.t("Show duration")})),!!e.enabledDuration&&s.a.createElement(ke.a,null,s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"widthDuration",type:"number",className:this.props.classes.field,label:S.a.t("Column width"),value:e.widthDuration,onChange:function(e){return t.onChange("widthDuration",e.target.value,e)}}),!!e.enabledHeader&&s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"textDuration",type:"text",className:this.props.classes.field,label:S.a.t("Header text"),value:e.textDuration,onChange:function(e){return t.onChange("textDuration",e.target.value,e)}})))}},{key:"renderSettingsTitle",value:function(e){var t=this;return s.a.createElement(Se.a,{expanded:this.state.expanded.includes("enabledTitle"),onChange:function(e,a){return t.onExpand("enabledTitle",a)}},s.a.createElement(xe.a,{expandIcon:s.a.createElement(we.a,null),classes:{content:Object(W.a)(this.props.classes.accordionContent,this.props.classes.noCheckbox)}},S.a.t("Title")),s.a.createElement(ke.a,null,s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"titleText",type:"text",className:this.props.classes.field,label:S.a.t("Title"),value:e.titleText,onChange:function(e){return t.onChange("titleText",e.target.value,e)}}),s.a.createElement(H,{color:e.titleColor,style:{width:300,display:"inline-block",marginRight:16},name:S.a.t("Color"),onChange:function(e){return t.onChange("titleColor",e)}}),s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"titleFontSize",type:"number",className:this.props.classes.field,label:S.a.t("Title"),value:e.titleFontSize,onChange:function(e){return t.onChange("titleFontSize",e.target.value,e)}})))}},{key:"renderPageNumbers",value:function(e){var t=this;return s.a.createElement(Se.a,{expanded:e.pageNumberEnabled&&this.state.expanded.includes("pageNumberEnabled"),onChange:function(e,a){return t.onExpand("pageNumberEnabled",a)}},s.a.createElement(xe.a,{expandIcon:e.pageNumberEnabled?s.a.createElement(we.a,null):null,classes:{content:this.props.classes.accordionContent}},s.a.createElement(F.a,{onFocus:function(e){return e.stopPropagation()},onClick:function(e){return e.stopPropagation()},key:"pageNumberEnabled",control:s.a.createElement(j.a,{checked:e.pageNumberEnabled||!1,onChange:function(e){return t.onChange("pageNumberEnabled",e.target.checked,e)}}),label:S.a.t("Show page numbers")})),!!e.pageNumberEnabled&&s.a.createElement(ke.a,null,s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"pageNumberFontSize",type:"number",className:this.props.classes.field,label:S.a.t("Font size"),value:e.pageNumberFontSize,onChange:function(e){return t.onChange("pageNumberFontSize",e.target.value,e)}}),s.a.createElement(H,{color:e.pageNumberColor,style:{width:300,display:"inline-block",marginRight:16},name:S.a.t("Color"),onChange:function(e){return t.onChange("pageNumberColor",e)}}),s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"pageNumberOffsetX",type:"number",className:this.props.classes.field,label:S.a.t("X Offset"),value:e.pageNumberOffsetX,onChange:function(e){return t.onChange("pageNumberOffsetX",e.target.value,e)}}),s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"pageNumberOffsetY",type:"number",className:this.props.classes.field,label:S.a.t("Y Offset"),value:e.pageNumberOffsetY,onChange:function(e){return t.onChange("pageNumberOffsetY",e.target.value,e)}})))}},{key:"renderPageMargins",value:function(e){var t=this;return s.a.createElement(Se.a,{expanded:this.state.expanded.includes("margins"),onChange:function(e,a){return t.onExpand("margins",a)}},s.a.createElement(xe.a,{expandIcon:s.a.createElement(we.a,null),classes:{content:Object(W.a)(this.props.classes.accordionContent,this.props.classes.noCheckbox)}},S.a.t("Margins")),s.a.createElement(ke.a,null,s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"top",type:"number",className:this.props.classes.field,label:S.a.t("Top"),value:e.margins.top,onChange:function(e){return t.onChange("margins.top",e.target.value,e)}}),s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"left",type:"number",className:this.props.classes.field,label:S.a.t("Left"),value:e.margins.left,onChange:function(e){return t.onChange("margins.left",e.target.value,e)}}),s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"bottom",type:"number",className:this.props.classes.field,label:S.a.t("Bottom"),value:e.margins.bottom,onChange:function(e){return t.onChange("margins.bottom",e.target.value,e)}}),s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"top",type:"right",className:this.props.classes.field,label:S.a.t("Right"),value:e.margins.right,onChange:function(e){return t.onChange("margins.right",e.target.value,e)}})))}},{key:"renderPageHeader",value:function(e){var t=this;return s.a.createElement(Se.a,{expanded:e.enabledHeader&&this.state.expanded.includes("enabledHeader"),onChange:function(e,a){return t.onExpand("enabledHeader",a)}},s.a.createElement(xe.a,{expandIcon:e.enabledHeader?s.a.createElement(we.a,null):null,classes:{content:this.props.classes.accordionContent}},s.a.createElement(F.a,{onFocus:function(e){return e.stopPropagation()},onClick:function(e){return e.stopPropagation()},key:"enabledHeader",control:s.a.createElement(j.a,{checked:e.enabledHeader||!1,onChange:function(e){return t.onChange("enabledHeader",e.target.checked,e)}}),label:S.a.t("Show table header")})),!!e.enabledHeader&&s.a.createElement(ke.a,null,s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"fontSizeHeader",type:"number",className:this.props.classes.field,label:S.a.t("Font size"),value:e.fontSizeHeader,onChange:function(e){return t.onChange("fontSizeHeader",e.target.value,e)}}),s.a.createElement(H,{color:e.colorHeaderBackground,style:{width:300,display:"inline-block",marginRight:16},name:S.a.t("Background"),onChange:function(e){return t.onChange("colorHeaderBackground",e)}}),s.a.createElement(H,{color:e.colorHeader,style:{width:300,display:"inline-block",marginRight:16},name:S.a.t("Text color"),onChange:function(e){return t.onChange("colorHeader",e)}})))}},{key:"renderSettingsText",value:function(e){var t=this;return s.a.createElement(Se.a,{expanded:this.state.expanded.includes("text"),onChange:function(e,a){return t.onExpand("text",a)}},s.a.createElement(xe.a,{expandIcon:s.a.createElement(we.a,null),classes:{content:Object(W.a)(this.props.classes.accordionContent,this.props.classes.noCheckbox)}},S.a.t("Text settings")),s.a.createElement(ke.a,null,s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"fontSize",type:"number",className:this.props.classes.field,label:S.a.t("Font size"),value:e.fontSize,onChange:function(e){return t.onChange("fontSize",e.target.value,e)}}),s.a.createElement(H,{color:e.textColor,style:{width:300,display:"inline-block",marginRight:16},name:S.a.t("Color"),onChange:function(e){return t.onChange("textColor",e)}}),s.a.createElement(H,{color:e.colorLineOdd,style:{width:300,display:"inline-block",marginRight:16},name:S.a.t("Odd line background"),onChange:function(e){return t.onChange("colorLineOdd",e)}}),s.a.createElement(H,{color:e.colorLineEven,style:{width:300,display:"inline-block",marginRight:16},name:S.a.t("Even line background"),onChange:function(e){return t.onChange("colorLineEven",e)}}),s.a.createElement(x.a,{disabled:this.state.pdfInGeneration,key:"lineHeight",type:"number",className:this.props.classes.field,label:S.a.t("Line height"),value:e.lineHeight,onChange:function(e){return t.onChange("lineHeight",e.target.value,e)}})))}},{key:"renderSettings",value:function(){var e=this,t=Object.assign({},$e,this.props.native.pdfSettings);return s.a.createElement(Ke.a,{item:!0,xs:12,md:12,lg:6},s.a.createElement(F.a,{key:"pdfButton",control:s.a.createElement(j.a,{checked:this.props.native.pdfButton||!1,onChange:function(t){return e.props.onChange("pdfButton",t.target.checked)}}),label:S.a.t("Show PDF generate button on list")}),this.renderPageHeader(t),this.renderSettingsTime(t),this.renderSettingsEvent(t),this.renderSettingsValue(t),this.renderSettingsDuration(t),this.renderSettingsTitle(t),this.renderPageNumbers(t),this.renderPageMargins(t),this.renderSettingsText(t))}},{key:"renderPdfFile",value:function(){return s.a.createElement(Ke.a,{item:!0,xs:12,md:12,lg:6},s.a.createElement("iframe",{title:"pdf",className:this.props.classes.iframePdfLandscape,src:"/files/eventlist/report.pdf?q="+this.state.random}))}},{key:"renderMessage",value:function(){var e=this;return this.state.messageText?s.a.createElement(Xe.a,{title:S.a.t("Success"),onClose:function(){return e.setState({messageText:""})}},this.state.messageText):null}},{key:"render",value:function(){return s.a.createElement("form",{className:this.props.classes.tab},s.a.createElement(Ke.a,{container:!0,spacing:1,className:this.props.classes.gridContainer},this.renderSettings(),this.renderPdfFile()))}}]),a}(n.Component),Ze=Object(h.a)((function(e){return{tab:{width:"100%",height:"100%"},gridContainer:{width:"100%",height:"100%"},button:{marginRight:20},settingsDivLandscape:{},iframePdfLandscape:{width:"100%",height:"100%"},field:{width:100,marginRight:e.spacing(1)},accordionContent:{marginTop:0,marginBottom:0},noCheckbox:{paddingLeft:32}}}))(Qe),et=a(183),tt=a.n(et),at=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(c.a)(this,a),n=t.call(this,e);var s=window.localStorage.getItem("eventlist.app.messangers")||"[]";try{s=JSON.parse(s)}catch(r){}return n.state={showHint:!1,toast:"",errorText:"",messageText:"",telegramInstances:[],whatsappInstances:[],expanded:s},n.aliveId="system.adapter.".concat(n.props.adapterName,".").concat(n.props.instance,".alive"),n.triggerPDFId="".concat(n.props.adapterName,".").concat(n.props.instance,".triggerPDF"),n.props.socket.getAdapterInstances("telegram").then((function(e){return n.props.socket.getAdapterInstances("whatsapp-cmb").then((function(t){n.setState({telegramInstances:e.map((function(e){return e._id.split(".").pop()})),whatsappInstances:t.map((function(e){return e._id.split(".").pop()}))})}))})),n}return Object(u.a)(a,[{key:"showError",value:function(e){this.setState({errorText:e})}},{key:"renderError",value:function(){var e=this;return this.state.errorText?s.a.createElement(tt.a,{text:this.state.errorText,title:S.a.t("Error"),onClose:function(){return e.setState({errorText:""})}}):null}},{key:"renderToast",value:function(){var e=this;return this.state.toast?s.a.createElement(O.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:!0,autoHideDuration:6e3,onClose:function(){return e.setState({toast:""})},ContentProps:{"aria-describedby":"message-id"},message:s.a.createElement("span",{id:"message-id"},this.state.toast),action:[s.a.createElement(D.a,{key:"close","aria-label":"Close",color:"inherit",className:this.props.classes.close,onClick:function(){return e.setState({toast:""})}},s.a.createElement(A.b,null))]}):null}},{key:"onExpand",value:function(e,t){var a=Object(Ye.a)(this.state.expanded);if(t)!a.includes(e)&&a.push(e);else{var n=a.indexOf(e);-1!==n&&a.splice(n,1)}window.localStorage.setItem("eventlist.app.messangers",JSON.stringify(a)),this.setState({expanded:a})}},{key:"renderTelegram",value:function(){var e=this;return s.a.createElement(Se.a,{expanded:this.state.expanded.includes("telegram"),onChange:function(t,a){return e.onExpand("telegram",a)}},s.a.createElement(xe.a,{expandIcon:s.a.createElement(we.a,null),classes:{content:this.props.classes.accordionContent}},"Telegram"),s.a.createElement(ke.a,null,s.a.createElement(T.a,{className:this.props.classes.field},s.a.createElement(w.a,null,S.a.t("Instance")),s.a.createElement(N.a,{value:this.props.native.telegram||"none",onChange:function(t){return e.props.onChange("telegram","none"===t.target.value?"":t.target.value)}},s.a.createElement(I.a,{value:"none"},S.a.t("Disabled")),this.state.telegramInstances.map((function(e){return s.a.createElement(I.a,{value:e.toString()},"telegram.",e)})))),""!==this.props.native.telegram&&null!==this.props.native.telegram&&void 0!==this.props.native.telegram&&s.a.createElement(x.a,{key:"telegramUser",type:"text",className:this.props.classes.field,label:S.a.t("Telegram user"),value:this.props.native.telegramUser,onChange:function(t){return e.props.onChange("telegramUser",t.target.value)}})))}},{key:"renderWhatsApp",value:function(){var e=this;return s.a.createElement(Se.a,{expanded:this.state.expanded.includes("whatsapp"),onChange:function(t,a){return e.onExpand("whatsapp",a)}},s.a.createElement(xe.a,{expandIcon:s.a.createElement(we.a,null),classes:{content:this.props.classes.accordionContent}},"WhatsApp"),s.a.createElement(ke.a,null,s.a.createElement(T.a,{className:this.props.classes.field},s.a.createElement(w.a,null,S.a.t("Instance")),s.a.createElement(N.a,{value:this.props.native.whatsapp||"none",onChange:function(t){return e.props.onChange("whatsapp","none"===t.target.value?"":t.target.value)}},s.a.createElement(I.a,{value:"none"},S.a.t("Disabled")),this.state.whatsappInstances.map((function(e){return s.a.createElement(I.a,{value:e.toString()},"whatsapp-cmb.",e)})))),""!==this.props.native.whatsapp&&null!==this.props.native.whatsapp&&void 0!==this.props.native.whatsapp&&s.a.createElement(x.a,{key:"whatsappPhone",type:"text",className:this.props.classes.field,label:S.a.t("WhatsApp phone"),value:this.props.native.whatsappPhone,onChange:function(t){return e.props.onChange("whatsappPhone",t.target.value)}})))}},{key:"renderMessage",value:function(){var e=this;return this.state.messageText?s.a.createElement(Xe.a,{title:S.a.t("Success"),onClose:function(){return e.setState({messageText:""})}},this.state.messageText):null}},{key:"render",value:function(){return s.a.createElement("form",{className:this.props.classes.tab},this.renderTelegram(),this.renderWhatsApp(),this.renderToast(),this.renderMessage(),this.renderError())}}]),a}(n.Component),nt=Object(h.a)((function(e){return{tab:{width:"100%",height:"100%"},field:{width:150,marginRight:e.spacing(1)}}}))(at),st=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var s;Object(c.a)(this,n);var r=Object(l.a)({},e);return r.translations={en:a(521),de:a(522),ru:a(523),pt:a(524),nl:a(525),fr:a(526),it:a(527),es:a(528),pl:a(529),"zh-cn":a(530)},r.bottomButtons=!0,window.location.pathname.includes("adapter/")||"3000"===window.location.port?(window.location.pathname.includes("/tab.html")||window.location.pathname.includes("/tab_m.html"))&&(r.bottomButtons=!1):r.bottomButtons=!1,(s=t.call(this,e,r)).isTab=!r.bottomButtons,s}return Object(u.a)(n,[{key:"getSelectedTab",value:function(){var e=this.state.selectedTab;return e&&"options"!==e?"list"===e?1:"pdf"===e?2:"messengers"===e?3:void 0:0}},{key:"renderTabsForConfig",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement(m.a,{position:"static"},s.a.createElement(g.a,{value:this.getSelectedTab(),onChange:function(t,a){return e.selectTab(t.target.parentNode.dataset.name,a)}},s.a.createElement(f.a,{label:S.a.t("Options"),"data-name":"options"}),s.a.createElement(f.a,{label:S.a.t("Event list"),"data-name":"list"}),s.a.createElement(f.a,{label:S.a.t("PDF"),"data-name":"pdf"}),s.a.createElement(f.a,{label:S.a.t("Messengers"),"data-name":"messengers"}))),s.a.createElement("div",{className:this.isIFrame?this.props.classes.tabContentIFrame:this.props.classes.tabContent},("options"===this.state.selectedTab||!this.state.selectedTab)&&s.a.createElement(z,{key:"options",common:this.common,socket:this.socket,native:this.state.native,onError:function(t){return e.setState({errorText:!t&&0!==t||"string"===typeof t?t:t.toString()})},onLoad:function(t){return e.onLoadConfig(t)},instance:this.instance,adapterName:this.adapterName,changed:this.state.changed,onChange:function(t,a,n){return e.updateNativeValue(t,a,n)}}),"list"===this.state.selectedTab&&this.renderEventList(),"pdf"===this.state.selectedTab&&s.a.createElement(Ze,{key:"pdf",common:this.common,socket:this.socket,native:this.state.native,onError:function(t){return e.setState({errorText:t})},instance:this.instance,adapterName:this.adapterName,onChange:function(t,a,n){return e.updateNativeValue(t,a,n)}}),"messengers"===this.state.selectedTab&&s.a.createElement(nt,{key:"messengers",common:this.common,socket:this.socket,native:this.state.native,onError:function(t){return e.setState({errorText:t})},instance:this.instance,adapterName:this.adapterName,onChange:function(t,a,n){return e.updateNativeValue(t,a,n)}})),this.renderSaveCloseButtons())}},{key:"renderEventList",value:function(){var e=this;return s.a.createElement(Ue,{key:"enums",editEnabled:!this.isTab,showEditButton:this.isTab,themeName:this.state.themeName,themeType:this.state.themeType,common:this.common,socket:this.socket,native:this.state.native,onError:function(t){return e.setState({errorText:!t&&0!==t||"string"===typeof t?t:t.toString()})},instance:this.instance,adapterName:this.adapterName})}},{key:"render",value:function(){return this.state.loaded?s.a.createElement(o.a,{theme:this.state.theme},s.a.createElement("div",{className:"App",style:{background:this.state.theme.palette.background.default,color:this.state.theme.palette.text.primary}},this.isTab?this.renderEventList():this.renderTabsForConfig(),this.renderError())):s.a.createElement(o.a,{theme:this.state.theme},s.a.createElement(C.a,{theme:this.state.themeType}))}}]),n}(b.a),rt=Object(h.a)((function(e){return{root:{},tabContent:{padding:10,height:"calc(100% - 64px - 48px - 20px)",overflow:"auto"},tabContentIFrame:{padding:10,height:"calc(100% - 64px - 48px - 20px - 38px)",overflow:"auto"}}}))(st);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var it=a(192),ot=a(188),lt=a.n(ot);window.adapterName="eventlist";var ct=Ge.a.getThemeName();console.log("iobroker."+window.adapterName+"@"+it.a+' using theme "'+ct+'"'),window.location.host,function e(){return i.a.render(s.a.createElement(o.a,{theme:lt()(ct)},s.a.createElement(rt,{onThemeChange:function(t){ct=t,e()}})),document.getElementById("root"))}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[283,1,2]]]);
//# sourceMappingURL=main.383dfd23.chunk.js.map